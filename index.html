]<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Game Catur Ringan</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}
.container {
    background: #0f172a;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
}
h1 {
    text-align: center;
    margin-bottom: 10px;
}
.controls {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
}
select, button {
    padding: 6px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
}
button {
    background: #22c55e;
    cursor: pointer;
}
button:hover {
    background: #16a34a;
}
#board {
    display: grid;
    grid-template-columns: repeat(8, 60px);
    grid-template-rows: repeat(8, 60px);
    border: 3px solid #94a3b8;
}
.square {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    cursor: pointer;
}
.white { background: #e5e7eb; color: black; }
.black { background: #475569; }
.selected {
    outline: 3px solid yellow;
}
.info {
    text-align: center;
    margin-top: 10px;
    font-size: 14px;
}
</style>
</head>
<body>

<div class="container">
<h1>♟ Game Catur</h1>

<div class="controls">
<select id="level">
<option value="1">Level 1 - Mudah</option>
<option value="2">Level 2 - Sulit</option>
<option value="3">Level 3 - Hard</option>
</select>
<button onclick="resetGame()">Reset</button>
</div>

<div id="board"></div>
<div class="info" id="info">Giliran kamu (Putih)</div>
</div>

<script>
const pieces = {
    r:"♜", n:"♞", b:"♝", q:"♛", k:"♚", p:"♟",
    R:"♖", N:"♘", B:"♗", Q:"♕", K:"♔", P:"♙"
};

let board = [];
let selected = null;
let turn = "white";

function initBoard() {
    board = [
        "rnbqkbnr",
        "pppppppp",
        "........",
        "........",
        "........",
        "........",
        "PPPPPPPP",
        "RNBQKBNR"
    ].map(r => r.split(""));
}

function drawBoard() {
    const el = document.getElementById("board");
    el.innerHTML = "";
    for (let y = 0; y < 8; y++) {
        for (let x = 0; x < 8; x++) {
            const sq = document.createElement("div");
            sq.className = "square " + ((x+y)%2==0 ? "white":"black");
            if (selected && selected.x==x && selected.y==y)
                sq.classList.add("selected");
            const p = board[y][x];
            if (p !== ".") sq.textContent = pieces[p];
            sq.onclick = () => clickSquare(x,y);
            el.appendChild(sq);
        }
    }
}

function clickSquare(x,y) {
    if (turn !== "white") return;
    const p = board[y][x];
    if (selected) {
        move(selected.x, selected.y, x, y);
        selected = null;
    } else if (p !== "." && p === p.toUpperCase()) {
        selected = {x,y};
    }
    drawBoard();
}

function move(x1,y1,x2,y2) {
    board[y2][x2] = board[y1][x1];
    board[y1][x1] = ".";
    turn = "black";
    document.getElementById("info").textContent = "Giliran AI...";
    setTimeout(aiMove, 500);
}

function aiMove() {
    const level = document.getElementById("level").value;
    let moves = getAllMoves("black");
    if (moves.length === 0) return;

    let move;
    if (level == 1) {
        move = moves[Math.floor(Math.random()*moves.length)];
    } else if (level == 2) {
        move = moves.sort((a,b)=>b.score-a.score)[0];
    } else {
        move = minimaxRoot(2);
    }

    board[move.toY][move.toX] = board[move.fromY][move.fromX];
    board[move.fromY][move.fromX] = ".";
    turn = "white";
    document.getElementById("info").textContent = "Giliran kamu (Putih)";
    drawBoard();
}

function getAllMoves(color) {
    let list = [];
    for (let y=0;y<8;y++) for (let x=0;x<8;x++) {
        let p = board[y][x];
        if (p===".") continue;
        if (color=="black" && p===p.toLowerCase()) {
            for (let dy=-1;dy<=1;dy++) for (let dx=-1;dx<=1;dx++) {
                let nx=x+dx, ny=y+dy;
                if (nx>=0&&nx<8&&ny>=0&&ny<8) {
                    let t = board[ny][nx];
                    if (t==="." || t===t.toUpperCase()) {
                        list.push({
                            fromX:x, fromY:y,
                            toX:nx, toY:ny,
                            score: t==="."?0:5
                        });
                    }
                }
            }
        }
    }
    return list;
}

function minimaxRoot(depth) {
    let best = -9999;
    let bestMove;
    getAllMoves("black").forEach(m=>{
        let captured = board[m.toY][m.toX];
        board[m.toY][m.toX] = board[m.fromY][m.fromX];
        board[m.fromY][m.fromX] = ".";
        let score = -minimax(depth-1);
        board[m.fromY][m.fromX] = board[m.toY][m.toX];
        board[m.toY][m.toX] = captured;
        if (score > best) {
            best = score;
            bestMove = m;
        }
    });
    return bestMove;
}

function minimax(depth) {
    if (depth==0) return Math.random();
    let best = -9999;
    getAllMoves("white").forEach(m=>{
        best = Math.max(best, Math.random());
    });
    return best;
}

function resetGame() {
    initBoard();
    turn="white";
    selected=null;
    document.getElementById("info").textContent = "Giliran kamu (Putih)";
    drawBoard();
}

initBoard();
drawBoard();
</script>

</body>
</html>
